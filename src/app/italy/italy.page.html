<ion-header>
  <ion-toolbar>
    <ion-title>Italy</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content padding>
    <div id="map"></div>
    <script>
      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12,
            center: {lat: 41.8719, lng: 12.5674},
            mapTypeControl: true,
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                position: google.maps.ControlPosition.TOP_CENTER
            },
            zoomControl: true,
            zoomControlOptions: {
                position: google.maps.ControlPosition.LEFT_CENTER
            },
            scaleControl: true,
            streetViewControl: true,
            streetViewControlOptions: {
                position: google.maps.ControlPosition.LEFT_TOP
            },
            fullscreenControl: true
          });
      }
  
      //finds the weather for the current location
      function getWeather(lat, long) {
          const http = new XMLHttpRequest();
          var key = "224b67f51b7ea38090352a2411028bcb";
          var url = 'http://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + long + '&appid=' + key + '&units=imperial';
          //let request = require('request');
          console.log(url);
  
          http.onreadystatechange=function() {
              if (this.readyState == 4 && this.status == 200) {
                  //var weather = JSON.parse(http.responseText);
                  console.log(http.responseText);
                  var weather = JSON.parse(this.responseText);
                  console.log(weather.main.temp);
                  document.getElementById("weather").innerHTML = weather.main.temp + '°';
              }
          };
  
          http.open("GET", url, true);
          http.send();
      }
    </script>
    <iframe width="99%" height="200" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/view?center=41.8719,12.5674&zoom=4&key=AIzaSyDhPOl-YIJj5lZ6aFrV3lt8WsZv-qVVAAY" allowfullscreen></iframe>
    <script async defer src="http://maps.google.com/maps/api/js?key=AIzaSyDhPOl-YIJj5lZ6aFrV3lt8WsZv-qVVAAY&callback=initMap"></script>
    <h3>Rome</h3>
    <h3 id="weather" onload="getWeather(41.8719, 12.5674)">54°</h3>
    <img src="/../assets/img/rom.jpg">
    <h4>Place to visit:</h4>
    <p>The Colosseum</p>
    <p>The Pantheon</p>
    <p>The Trevi Fountain</p>
    <p>Sistine Chapel</p>
    <p>Piazza Navona</p>
    <p>Spanish Steps</p>
    <p>St. Peter's Basillica</p>
  </ion-content>
